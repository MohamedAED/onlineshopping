<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org/">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Order Details</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script type="text/javascript" th:src="@{/js/cart.js}"></script>
    <style>
    .re{
    width:300px;
    }
    .max{
    	width:500px;
    }
    </style>
</head>

<body>

<input type="hidden" id="buyerId" name="buyerId" th:value="${buyerId}" />

<section>
    <div class="pull-right" style="padding-right:50px">
        <a th:href="@{/}">Products</a> | <a th:href="@{/buyerOrders(buyerId=${buyerId})}">Your Orders</a> | <a th:href="@{/shoppingCart(buyerId=${buyerId})}">Shopping Cart</a>
    </div>
</section>

<section>
    <div class="jumbotron">
        <div class="container">
            <h2>Your Orders</h2>
        </div>
    </div>
</section>

<section class="container">
	<div id="global">
	    <form action="#" th:action="@{/order}" method="post">
	    	<fieldset>
	    		<table th:each="placeOrder : ${placedOrders}" class="table table-hover" border=1 frame=void rules=rows>
	    			<tr>
				      	<th th:text="#{placeOrder.form.orderDate}">Order Placed</th>
				      	<th th:text="#{placeOrder.form.totalPrice}">Total Price</th>
				      	<th th:text="#{placeOrder.form.orderNumber}">Order #</th>
				      	<th th:text="#{placeOrder.form.shipTo}">Ship To</th>
				    </tr>
	    			<tr>
	    				<td th:text="${placeOrder.orderDate}"></td>
				    	<td th:text="${placeOrder.totalPrice}"></td>
				    	<td th:text="${placeOrder.orderNumber}"></td>
				    	<td th:text="${buyerName}"></td>
	    			</tr>
	    			<tr></tr>
	    			<tr>
						<td th:text="${placeOrder.status}"></td>
						<td>&nbsp;&nbsp;</td>
	    				<td th:text="${placeOrder.orderDeliveryDate}? ${placeOrder.orderDeliveryDate}: (${placeOrder.orderShippingDate}? ${placeOrder.orderShippingDate} : ${placeOrder.orderDate})"></td>
	    				<td>&nbsp;&nbsp;</td>
                       	<td><a href="#" class="label label-success placeOrder-print-btn" th:data="${placeOrder.id}" id="placeOrder-print-btn" name="placeOrder-print-btn">
 								<span class="glyphicon glyphicon-download-alt" /></span> download receipt </a></td>
	    			</tr>
	    			<tr></tr>
	    			<tr th:each="item : ${placeOrder.cartItems}">
				    	<td><img th:src="@{'/images/products/' + ${item.product.id} + '.jpg'}" width="200" height="100"></td>
                        <td>
                        	<table>
                          		<tr><td class="max" th:text="${item.product.description}">Description</td></tr>
                          		<tr><td th:text="${item.quantity}">Quantity</td>   </tr>
                          		<tr><td th:text="${item.product.price}">Price</td></tr>
                          		<tr>
                          			<td>
                          				<a href="#" th:id="${item.product.id}" onclick="manageReview(this.id)" class="label label-success" th:data="${item.product.id}">
                          					<span class="glyphicon glyphicon-pencil" /></span> Write a product review </a>
			 						</td>
			 					</tr>
                          		<tr>
                          			<td>
	                          			<div th:id="${'div' + item.product.id}" style="display:none">
	                          				<br/>
											<textarea th:id="${'textReview' + item.product.id}" name="textReview" rows="4" cols="50"></textarea>
											<br/>
											<a href="#" class="label label-success product-review-btn" th:data="${item.product.id}" id="product-review-btn" name="product-review-btn">
			 									<span class="glyphicon glyphicon-ok" /></span> Submit </a>
			 								&nbsp;&nbsp;
			 								<a href="#" th:id="${item.product.id}" onclick="manageReview(this.id)" class="label label-danger">
                      							<span class="glyphicon glyphicon-remove" /></span> Cancel </a>
										</div>
									</td>
								</tr>
                        	</table>
                        </td>
				    </tr>
				    <tr></tr>
				    <tr></tr>
	    		</table>
			</fieldset>
			<p></p>
	    </form>
	    <br/><br/>
	    <div>
	    	<a th:href="@{/}" class="btn btn-default"><span class="glyphicon-hand-left glyphicon"></span> Continue shopping </a>
        </div>
        <br/><br/><br/><br/>
	</div>
</section>

<script>
function manageReview(divId) {
  var divValue = document.getElementById("div" + divId);
  if (divValue.style.display === "none") {
	  divValue.style.display = "block";
  } else {
	  divValue.style.display = "none";
  }
}
</script>

</body>
</html>